//
//  UIColor+SwissTrains.m
//  Swiss Trains
//
//  Created by Alain on 28.11.12.
//  Copyright (c) 2012 Zone Zero Apps. All rights reserved.
//

#import "UIColor+SwissTrains.h"

@implementation UIColor (SwissTrains)

#define kBoxAlpha 0.95f

+(UIColor *) connectionsOverviewCellTopGradientColorSelected {
    return [UIColor colorWithRed:198.0/255.0f green:199.0/255.0f blue:200.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:228.0/255.0f green:229.0/255.0f blue:230.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:248.0/255.0f green:248.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:246.0/255.0f green:247.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:247.0/255.0f green:247.0/255.0f blue:247.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:240.0/255.0f green:238.0/255.0f blue:237.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:1.f green:1.f blue:1.f alpha:kBoxAlpha];
}

+(UIColor *) connectionsOverviewCellBottomGradientColorSelected {
    return [UIColor colorWithRed:165.0/255.0f green:168.0/255.0f blue:173.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:195.0/255.0f green:198.0/255.0f blue:203.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:213.0/255.0f green:216.0/255.0f blue:221.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:227.0/255.0f green:229.0/255.0f blue:234.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:220.0/255.0f green:219.0/255.0f blue:218.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:0.93f green:0.93f blue:0.93f alpha:kBoxAlpha];
}

+(UIColor *) connectionsOverviewCellTopGradientColorNormal {
    //return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:198.0/255.0f green:199.0/255.0f blue:200.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:248.0/255.0f green:248.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:246.0/255.0f green:247.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:247.0/255.0f green:247.0/255.0f blue:247.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:240.0/255.0f green:238.0/255.0f blue:237.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:1.f green:1.f blue:1.f alpha:kBoxAlpha];
}

+(UIColor *) connectionsOverviewCellBottomGradientColorNormal {
    //return [UIColor colorWithRed:230.0/255.0f green:230.0/255.0f blue:230.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:165.0/255.0f green:168.0/255.0f blue:173.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:213.0/255.0f green:216.0/255.0f blue:221.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:227.0/255.0f green:229.0/255.0f blue:234.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:220.0/255.0f green:219.0/255.0f blue:218.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:0.93f green:0.93f blue:0.93f alpha:kBoxAlpha];
}





+(UIColor *) connectionsDetailviewCellTopGradientColorSelected {
    return [UIColor colorWithRed:198.0/255.0f green:199.0/255.0f blue:200.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:248.0/255.0f green:248.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:246.0/255.0f green:247.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:247.0/255.0f green:247.0/255.0f blue:247.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:240.0/255.0f green:238.0/255.0f blue:237.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:1.f green:1.f blue:1.f alpha:kBoxAlpha];
}

+(UIColor *) connectionsDetailviewCellBottomGradientColorSelected {
    return [UIColor colorWithRed:165.0/255.0f green:168.0/255.0f blue:173.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:213.0/255.0f green:216.0/255.0f blue:221.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:227.0/255.0f green:229.0/255.0f blue:234.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:220.0/255.0f green:219.0/255.0f blue:218.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:0.93f green:0.93f blue:0.93f alpha:kBoxAlpha];
}

+(UIColor *) connectionsDetailviewCellTopGradientColorNormal {
    return [self connectionsOverviewCellTopGradientColorNormal];
    //return [UIColor colorWithRed:248.0/255.0f green:248.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:246.0/255.0f green:247.0/255.0f blue:248.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:247.0/255.0f green:247.0/255.0f blue:247.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:240.0/255.0f green:238.0/255.0f blue:237.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:1.f green:1.f blue:1.f alpha:kBoxAlpha];
}

+(UIColor *) connectionsDetailviewCellBottomGradientColorNormal {
    return [self connectionsOverviewCellBottomGradientColorNormal];
    //return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:213.0/255.0f green:216.0/255.0f blue:221.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:227.0/255.0f green:229.0/255.0f blue:234.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:220.0/255.0f green:219.0/255.0f blue:218.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithRed:0.93f green:0.93f blue:0.93f alpha:kBoxAlpha];
}

+(UIColor *) rssDetailBackgroundColor {
    return [UIColor colorWithRed:244.0/255.0f green:244.0/255.0f blue:244.0/255.0f alpha:1.0];
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) listviewControllersBackgroundColor {
    //return [UIColor colorWithRed:255.0/255.0f green:255.0/255.0f blue:255.0/255.0f alpha:1.0];
    return [UIColor colorWithRed:250.0/255.0f green:250.0/255.0f blue:250.0/255.0f alpha:1.0];
    return [UIColor colorWithRed:239.0/255.0f green:239.0/255.0f blue:239.0/255.0f alpha:1.0];
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) selectionControllerBackgroundColor {
    //return [UIColor colorWithWhite: 0.4 alpha:1.0];
    return [UIColor colorWithWhite: 0.95 alpha:1.0];
    return [UIColor colorWithRed:225.0/255.0f green:225.0/255.0f blue:225.0/255.0f alpha:kBoxAlpha];
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

// -------------------------------------------------------------------------------------

+(UIColor *) requestSegmentedControlTopGradientColor {
    return [UIColor colorWithWhite: 0.4 alpha:1.0];
}

+(UIColor *) requestSegmentedControlBottomGradientColor {
    return [UIColor colorWithWhite: 0.1 alpha:1.0];
}

+(UIColor *) requestSegmentedControlItemViewBackgroundColor {
    return [UIColor colorWithWhite:0.5 alpha:0.8];
}

+(UIColor *) requestSegmentedControlItemViewTextColorNormal {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) requestSegmentedControlItemViewTextColorSelected {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) requestSegmentedControlItemViewTextColorDisabled {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) requestSegmentedControlItemViewTextColorNormalShadow {
    return [UIColor colorWithWhite:0.4 alpha:1];
}

+(UIColor *) requestSegmentedControlItemViewTextColorSelectedShadow {
    return [UIColor colorWithWhite:0.4 alpha:1];
}

+(UIColor *) requestSegmentedControlItemViewTextColorDisabledShadow {
    return [UIColor colorWithWhite:0.4 alpha:1];
}

+(UIColor *) requestSegmentedControlItemViewInnerCircleBottomShadowColor {
    return [UIColor colorWithWhite:0.6 alpha:1];
}

+(UIColor *) requestSegmentedControlItemImageColor {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) requestSegmentedControlButtonsImageColorNormal {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) requestSegmentedControlButtonsImageColorHighlighted {
    return [UIColor colorWithWhite:0.6 alpha:1];
}

// -------------------------------------------------------------------------------------

+(UIColor *) toolbarTopGradientColor {
    return [UIColor colorWithWhite: 0.4 alpha:1.0];
}

+(UIColor *) toolbarBottomGradientColor {
    return [UIColor colorWithWhite: 0.1 alpha:1.0];
}

+(UIColor *) toolbarTextColorNormal {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) toolbarButtonsImageColorNormal {
    return [UIColor colorWithWhite:0.9 alpha:1];
}

+(UIColor *) toolbarButtonsImageColorHighlighted {
    return [UIColor colorWithWhite:0.6 alpha:1];
}

// -------------------------------------------------------------------------------------


+(UIColor *) greyBackgroundPatternImageColor {
    //return [UIColor colorWithWhite: 0.4 alpha:1.0];
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) darkBackgroundPatternImageColor {
    return [UIColor darkGrayColor];
}

+(UIColor *) selectStationsViewButtonColorNormal {
    return [UIColor lightGrayColor];
}

+(UIColor *) selectStationsViewButtonColorHighlighted {
    return [UIColor darkGrayColor];
}

+(UIColor *) selectStationsViewFTWButtonColorNormal {
    return [UIColor colorWithWhite: 0.98 alpha:1.0];
}

+(UIColor *) selectStationsViewFTWButtonColorHighlighted {
    return [UIColor darkGrayColor];
}

+(UIColor *) overviewTableviewBackgroundColor {
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) overviewCellTextColorNormal {
    return [UIColor darkGrayColor];
}

+(UIColor *) overviewCellTextColorSelected {
    return [UIColor darkGrayColor];
    return [UIColor whiteColor];
}

+(UIColor *) overviewCellBackgroundColorNormal {
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) overviewCellBackgroundColorSelected {
    //return [UIColor blackColor];
    //return [UIColor colorWithWhite:0.5 alpha:0.5];
    return [UIColor colorWithWhite:0.8 alpha:1.0];
}

+(UIColor *) detailTableviewBackgroundColor {
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) detailCellBackgroundColorNormal {
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) detailCellBackgroundColorSelected {
    return [UIColor colorWithWhite:0.8 alpha:1.0];
    return [UIColor darkGrayColor];
}

+(UIColor *) detailTableViewCellTextColorNormal {
    return [UIColor darkGrayColor];
}

+(UIColor *) detailTableViewCellTextColorExpectedInfo {
    return [UIColor redColor];
}

+(UIColor *) detailTableViewCellImageColorExpectedInfo {
    return [UIColor redColor];
}

+(UIColor *) detailTableViewCellTrainImageColor {
    return [UIColor blueColor];
}

+(UIColor *) detailTableViewCellTramBusImageColor {
    return [UIColor orangeColor];
}

+(UIColor *) detailTableViewCellShipImageColor {
    return [UIColor greenColor];
}

+(UIColor *) detailTableViewCellWalkImageColor {
    return [UIColor darkGrayColor];
}

+(UIColor *) detailTableViewCellChangeLineColor {
    return [UIColor lightGrayColor];
}

+(UIColor *) detailTableViewCellJourneyLineColor {
    return [UIColor blueColor];
}

+(UIColor *) detailTableViewCellJourneyInfoImageBackgroundColor {
    return [UIColor darkGrayColor];
}

+(UIColor *) detailTableViewCellJourneyInfoImageColor {
    return [UIColor lightGrayColor];
}

+(UIColor *) connectionsJourneyDetailViewTopInfoViewListBackgroundColor {
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) connectionsJourneyDetailViewTopInfoViewMapBackgroundColor {
    return [UIColor clearColor];
}

+(UIColor *) connectionsJourneyDetailViewTopInfoViewMapBackgroundColoriPad {
    return [UIColor colorWithWhite:0.2f alpha:0.6f];
}

+(UIColor *) stationboardBottomSelectionViewBackgroundColor {
    //return [UIColor clearColor];
    return [UIColor colorWithWhite:0.2f alpha:1.0f];
}

+(UIColor *) connectionsJourneyDetailViewBottomInfoViewListBackgroundColor {
    return [UIColor colorWithWhite:0.5f alpha:1.0f];
    return [UIColor colorWithPatternImage:[UIImage imageNamed:@"Background.png"]];
}

+(UIColor *) connectionsJourneyDetailViewBottomInfoViewMapBackgroundColor {
    //return [UIColor clearColor];
    return [UIColor colorWithWhite:0.5f alpha:1.0f];
    return [UIColor colorWithWhite:0.2f alpha:1.0f];
}

+(UIColor *) connectionsJourneyDetailViewBottomInfoViewMapTextColor {
    return [UIColor whiteColor];
}

+(UIColor *) connectionsJourneyDetailViewBottomInfoViewListTextColor {
    return [UIColor whiteColor];
    return [UIColor darkGrayColor];
}

// -------------------------------------------------------------------------------------

//static NSMutableDictionary *colorNameCache = nil;

- (CGColorSpaceModel)colorSpaceModel {
	return CGColorSpaceGetModel(CGColorGetColorSpace(self.CGColor));
}

- (NSString *)colorSpaceString {
	switch (self.colorSpaceModel) {
		case kCGColorSpaceModelUnknown:
			return @"kCGColorSpaceModelUnknown";
		case kCGColorSpaceModelMonochrome:
			return @"kCGColorSpaceModelMonochrome";
		case kCGColorSpaceModelRGB:
			return @"kCGColorSpaceModelRGB";
		case kCGColorSpaceModelCMYK:
			return @"kCGColorSpaceModelCMYK";
		case kCGColorSpaceModelLab:
			return @"kCGColorSpaceModelLab";
		case kCGColorSpaceModelDeviceN:
			return @"kCGColorSpaceModelDeviceN";
		case kCGColorSpaceModelIndexed:
			return @"kCGColorSpaceModelIndexed";
		case kCGColorSpaceModelPattern:
			return @"kCGColorSpaceModelPattern";
		default:
			return @"Not a valid color space";
	}
}

- (BOOL)canProvideRGBComponents {
	switch (self.colorSpaceModel) {
		case kCGColorSpaceModelRGB:
		case kCGColorSpaceModelMonochrome:
			return YES;
		default:
			return NO;
	}
}

- (BOOL)red:(CGFloat *)red green:(CGFloat *)green blue:(CGFloat *)blue alpha:(CGFloat *)alpha {
	const CGFloat *components = CGColorGetComponents(self.CGColor);
    
	CGFloat r,g,b,a;
    
	switch (self.colorSpaceModel) {
		case kCGColorSpaceModelMonochrome:
			r = g = b = components[0];
			a = components[1];
			break;
		case kCGColorSpaceModelRGB:
			r = components[0];
			g = components[1];
			b = components[2];
			a = components[3];
			break;
		default:	// We don't know how to handle this model
			return NO;
	}
    
	if (red) *red = r;
	if (green) *green = g;
	if (blue) *blue = b;
	if (alpha) *alpha = a;
    
	return YES;
}

- (CGFloat)red {
	NSAssert(self.canProvideRGBComponents, @"Must be an RGB color to use -red");
	const CGFloat *c = CGColorGetComponents(self.CGColor);
	return c[0];
}

- (CGFloat)green {
	NSAssert(self.canProvideRGBComponents, @"Must be an RGB color to use -green");
	const CGFloat *c = CGColorGetComponents(self.CGColor);
	if (self.colorSpaceModel == kCGColorSpaceModelMonochrome) return c[0];
	return c[1];
}

- (CGFloat)blue {
	NSAssert(self.canProvideRGBComponents, @"Must be an RGB color to use -blue");
	const CGFloat *c = CGColorGetComponents(self.CGColor);
	if (self.colorSpaceModel == kCGColorSpaceModelMonochrome) return c[0];
	return c[2];
}

- (CGFloat)white {
	NSAssert(self.colorSpaceModel == kCGColorSpaceModelMonochrome, @"Must be a Monochrome color to use -white");
	const CGFloat *c = CGColorGetComponents(self.CGColor);
	return c[0];
}

- (CGFloat)alpha {
	return CGColorGetAlpha(self.CGColor);
}

- (UInt32)rgbHex {
	NSAssert(self.canProvideRGBComponents, @"Must be a RGB color to use rgbHex");
    
	CGFloat r,g,b,a;
	if (![self red:&r green:&g blue:&b alpha:&a]) return 0;
    
	r = MIN(MAX(self.red, 0.0f), 1.0f);
	g = MIN(MAX(self.green, 0.0f), 1.0f);
	b = MIN(MAX(self.blue, 0.0f), 1.0f);
    
	return (((int)roundf(r * 255)) << 16)
    | (((int)roundf(g * 255)) << 8)
    | (((int)roundf(b * 255)));
}

- (NSString *)stringFromColor {
	NSAssert(self.canProvideRGBComponents, @"Must be an RGB color to use -stringFromColor");
	NSString *result;
	switch (self.colorSpaceModel) {
		case kCGColorSpaceModelRGB:
			result = [NSString stringWithFormat:@"{%0.3f, %0.3f, %0.3f, %0.3f}", self.red, self.green, self.blue, self.alpha];
			break;
		case kCGColorSpaceModelMonochrome:
			result = [NSString stringWithFormat:@"{%0.3f, %0.3f}", self.white, self.alpha];
			break;
		default:
			result = nil;
	}
	return result;
}

- (NSString *)hexStringFromColor {
	return [NSString stringWithFormat:@"%0.6lX", self.rgbHex];
    //return [NSString stringWithFormat:@"%0.6X", self.rgbHex];
}

+ (UIColor *)colorWithString:(NSString *)stringToConvert {
	NSScanner *scanner = [NSScanner scannerWithString:stringToConvert];
	if (![scanner scanString:@"{" intoString:NULL]) return nil;
	const NSUInteger kMaxComponents = 4;
	CGFloat c[kMaxComponents];
	NSUInteger i = 0;
	if (![scanner scanFloat:&c[i++]]) return nil;
	while (1) {
		if ([scanner scanString:@"}" intoString:NULL]) break;
		if (i >= kMaxComponents) return nil;
		if ([scanner scanString:@"," intoString:NULL]) {
			if (![scanner scanFloat:&c[i++]]) return nil;
		} else {
			// either we're at the end of there's an unexpected character here
			// both cases are error conditions
			return nil;
		}
	}
	if (![scanner isAtEnd]) return nil;
	UIColor *color;
	switch (i) {
		case 2: // monochrome
			color = [UIColor colorWithWhite:c[0] alpha:c[1]];
			break;
		case 4: // RGB
			color = [UIColor colorWithRed:c[0] green:c[1] blue:c[2] alpha:c[3]];
			break;
		default:
			color = nil;
	}
	return color;
}

#pragma mark Class methods

+ (UIColor *)colorWithRGBHex:(UInt32)hex {
	int r = (hex >> 16) & 0xFF;
	int g = (hex >> 8) & 0xFF;
	int b = (hex) & 0xFF;
    
	return [UIColor colorWithRed:r / 255.0f
						   green:g / 255.0f
							blue:b / 255.0f
						   alpha:1.0f];
}

// Returns a UIColor by scanning the string for a hex number and passing that to +[UIColor colorWithRGBHex:]
// Skips any leading whitespace and ignores any trailing characters
+ (UIColor *)colorWithHexString:(NSString *)stringToConvert {
	NSScanner *scanner = [NSScanner scannerWithString:stringToConvert];
	unsigned hexNum;
	if (![scanner scanHexInt:&hexNum]) return nil;
	return [UIColor colorWithRGBHex:hexNum];
}

// -------------------------------------------------------------------------------------

- (BOOL)isEqualToColor:(UIColor *)otherColor {
    CGColorSpaceRef colorSpaceRGB = CGColorSpaceCreateDeviceRGB();
    
    UIColor *(^convertColorToRGBSpace)(UIColor*) = ^(UIColor *color) {
        if(CGColorSpaceGetModel(CGColorGetColorSpace(color.CGColor)) == kCGColorSpaceModelMonochrome) {
            const CGFloat *oldComponents = CGColorGetComponents(color.CGColor);
            CGFloat components[4] = {oldComponents[0], oldComponents[0], oldComponents[0], oldComponents[1]};
            return [UIColor colorWithCGColor:CGColorCreate(colorSpaceRGB, components)];
        } else
            return color;
    };
    
    UIColor *selfColor = convertColorToRGBSpace(self);
    otherColor = convertColorToRGBSpace(otherColor);
    CGColorSpaceRelease(colorSpaceRGB);
    
    return [selfColor isEqual:otherColor];
}

@end
